---
import IconMenu from "@/components/icons/icon-menu.astro";
import Socials from "@/components/widgets/socials.astro";
import Logo from "./logo.astro";
import Nav from "./nav.astro";
---

<header class="z-[60] bg-black/80 max-lg:pb-3 pb-1 pt-2">
  <div
    class="mx-auto flex w-full max-w-[77.5rem] items-center justify-between px-8 md:px-[66px] xl:max-w-[87.5rem]"
  >
    <Logo />

    <div class="flex items-center">
      <Nav />

      <Socials />

      <button id="menuButton" class="z-[9999] block p-4 lg:hidden">
        <IconMenu />
      </button>
    </div>
  </div>
</header>

<script>
  import { $ } from "@/lib/dom-selector";
  const nav = $(".nav");
  const menuButton = $("button");
  const menuSvg = $("#menuSvg");
  function toggleMenu(menuMobileContent: HTMLElement | null) {
    menuMobileContent?.classList.toggle("block");
    menuMobileContent?.classList.toggle("hidden");
    document.body.classList.toggle("overflow-hidden");
    document.body.classList.toggle("lg:overflow-auto");
  }

  function toggleMenuIcon(
    menuSvg: HTMLElement | null,
    openNavigation: boolean,
  ) {
    const rect1 = menuSvg?.querySelector("rect:nth-child(1)");
    const rect2 = menuSvg?.querySelector("rect:nth-child(2)");

    if (rect1 && rect2) {
      rect1.setAttribute("y", openNavigation ? "5" : "0");
      rect1.setAttribute("transform", `rotate(${openNavigation ? "45" : "0"})`);
      rect2.setAttribute("y", openNavigation ? "5" : "10");
      rect2.setAttribute(
        "transform",
        `rotate(${openNavigation ? "-45" : "0"})`,
      );
    }
  }

  menuButton?.addEventListener("click", () => {
    toggleMenu(nav);
    toggleMenuIcon(menuSvg, !nav.classList.contains("hidden"));
  });
</script>
